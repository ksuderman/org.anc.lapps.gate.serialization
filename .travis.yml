language: java
branches:
  only:
    - develop
    - master
    - /release.*/
env:
  global:
stages:
  - name: Unit Tests
    if: branch = develop
  - name: Staging
    if: branch =~ ^release
  - name: Master
    if: branch = master
jobs:
  include:
    - stage: Unit Tests
      install: mvn --settings settings.xml -DskipTests=true -Dmaven.javadoc.skip=true
        -Pdevelop -B -V install
      script: mvn --settings settings.xml -Pdevelop clean test
    - stage: Staging
      before_install: chmod +x deploy.sh
      install: mvn install --settings settings.xml -DskipTests=true -Dmaven.javadoc.skip=true -Pstaging -B -V
      script: mvn clean test --settings settings.xml -Dmaven.javadoc.skip=true -Pstaging -B -V
      after_success: ./deploy.sh
    - stage: Master
      install: mvn install --settings settings.xml -DskipTests=true -Dmaven.javadoc.skip=true -B -V
      script: mvn --settings settings.xml package
